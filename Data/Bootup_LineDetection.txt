
# set meta data

setuniform LineDetector MaskTopLeft=0.285x0.544
setuniform LineDetector MaskTopRight=0.768x0.552
setuniform LineDetector MaskBottomRight=0.982x0.840
setuniform LineDetector MaskBottomLeft=0.0x0.835

setuniform LineDetector RadialDistortionX=-.0900000036
setuniform LineDetector RadialDistortionY=.00999999978
setuniform LineDetector TangentialDistortionX=.0599999987
setuniform LineDetector TangentialDistortionY=0
setuniform LineDetector K5Distortion=0
setuniform LineDetector LensOffsetX=.0299999993
setuniform LineDetector LensOffsetY=.0500000007

setuniform LineDetector RectMergeMax=50
setuniform LineDetector AtlasWidth=128 AtlasHeight=512





# line detector
addstage LineDetector Hsl vert=ScreenQuad.vert frag=FrameToHsl.frag
addstage LineDetector WhiteFilterGroup cl=LineFilter.cl kernel=FilterWhite RenderAsRgb=0
#addstage LineDetector WhiteFilterGroup_rgb cl=LineFilter.cl kernel=FilterWhite RenderAsRgb=1
addstage LineDetector WhiteFilter cl=LineFilter.cl kernel=WhiteFilterEdges
#addstage LineDetector LineFilter cl=LineFilter.cl kernel=WhiteLineFilter
#addstage LineDetector HoughFilterPixels cl=LineFilter.cl kernel=HoughFilterPixels

#todo: make this loose, then do a refined filter on all matches
addstage LineDetector HoughFilter cl=LineFilter.cl kernel=HoughFilter HoughAngleStep=5 HoughDistanceStep=0.25

addstage LineDetector DrawHoughLines cl=LineFilter.cl kernel=DrawHoughLines HoughData=HoughFilter
#addstage LineDetector DrawHoughGraph cl=LineFilter.cl kernel=DrawHoughGraph HoughData=HoughFilter


#loadframe LineDetector time=1001 input01_undistorted.png
#decode LineDetector /Volumes/Assets/LiveLikeVideo/ManCity_Camera1_126.mp4
#decode LineDetector /Volumes/Assets/5goals.mp4
loadframe LineDetector FootballPitch.png time=1001
